{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";import{useFocusEffect,useNavigation}from'@react-navigation/native';import{observer}from'mobx-react';import{Container}from'native-base';import React,{useState,useRef,useEffect}from'react';import{useTranslation}from'react-i18next';import{initModify}from\"../../actions/app\";import TitleBar from\"../../components/titleBar\";import{useStores}from\"../../stores\";import ErrorPage from\"../error\";import Loading from\"../loading\";import*as Notifications from'expo-notifications';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ModifyPage=observer(function(){var stores=useStores();var _useTranslation=useTranslation(),i18n=_useTranslation.i18n,t=_useTranslation.t;var navigation=useNavigation();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),inited=_useState4[0],setInited=_useState4[1];useFocusEffect(function(){if(inited){return;}init();});var init=function _callee(){var errorMsg,notificationListener,responseListener,handlerNotificationReceived;return _regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setInited(true);setError('');_context.next=4;return _regeneratorRuntime.awrap(initModify({stores:stores,navigation:navigation,i18n:i18n}));case 4:errorMsg=_context.sent;if(errorMsg){setError(errorMsg);}notificationListener=useRef();responseListener=useRef();handlerNotificationReceived=function handlerNotificationReceived(notification){if(notification.origin==='selected'){}};useEffect(function(){init();responseListener.current=Notifications.addNotificationResponseReceivedListener(function(response){var page=response.notification.request.content.data.page;navigation.navigate(\"Home\",{screen:page});});notificationListener.current=Notifications.addNotificationReceivedListener(handlerNotificationReceived);return function(){Notifications.removeNotificationSubscription(responseListener);};},[]);case 10:case\"end\":return _context.stop();}}},null,null,null,Promise);};return _jsxs(Container,{children:[_jsx(TitleBar,{title:t('Common.PendingList'),onBack:function onBack(){navigation.reset({index:0,routes:[{name:'Home'}]});}}),error?_jsx(ErrorPage,{title:error,onRetry:init}):_jsx(Loading,{})]});});export default ModifyPage;","map":{"version":3,"names":["useFocusEffect","useNavigation","observer","Container","React","useState","useRef","useEffect","useTranslation","initModify","TitleBar","useStores","ErrorPage","Loading","Notifications","ModifyPage","stores","i18n","t","navigation","error","setError","inited","setInited","init","errorMsg","notificationListener","responseListener","handlerNotificationReceived","notification","origin","current","addNotificationResponseReceivedListener","response","page","request","content","data","navigate","screen","addNotificationReceivedListener","removeNotificationSubscription","reset","index","routes","name"],"sources":["I:/Workspace/mediWS/mccWS/frontend-clinic-app/src/pages/modify/index.tsx"],"sourcesContent":["import { useFocusEffect, useNavigation } from '@react-navigation/native';\r\nimport { observer } from 'mobx-react';\r\nimport { Container } from 'native-base';\r\nimport React, { useState, useRef, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { initModify } from '../../actions/app';\r\nimport TitleBar from '../../components/titleBar';\r\nimport { useStores } from '../../stores';\r\nimport ErrorPage from '../error';\r\nimport Loading from '../loading';\r\nimport * as Notifications from 'expo-notifications';\r\n\r\nconst ModifyPage = observer(() => {\r\n    const stores = useStores();\r\n    const { i18n, t } = useTranslation();\r\n    const navigation = useNavigation();\r\n\r\n    const [error, setError] = useState('');\r\n    const [inited, setInited] = useState(false);\r\n\r\n    useFocusEffect(() => {\r\n        if (inited) {\r\n            return;\r\n        }\r\n        init();\r\n    });\r\n\r\n    const init = async () => {\r\n        setInited(true);\r\n        setError('');\r\n        const errorMsg = await initModify({ stores, navigation, i18n });\r\n        if (errorMsg) {\r\n            setError(errorMsg);\r\n        }\r\n\r\n        const notificationListener: any = useRef<any>();\r\n        const responseListener: any = useRef<any>();\r\n    \r\n        const handlerNotificationReceived = (notification:any) => {\r\n            if(notification.origin === 'selected'){\r\n            }\r\n        };\r\n        \r\n        useEffect(() => {\r\n            init();\r\n    \r\n            responseListener.current = Notifications.addNotificationResponseReceivedListener(response => {\r\n                const page:any = response.notification.request.content.data.page;\r\n                navigation.navigate(\"Home\", {screen: page});\r\n            });\r\n    \r\n            notificationListener.current = Notifications.addNotificationReceivedListener(handlerNotificationReceived);\r\n    \r\n            return () => {\r\n                Notifications.removeNotificationSubscription(responseListener);\r\n            };\r\n    \r\n        }, []);\r\n    }\r\n\r\n    return (\r\n        <Container>\r\n            <TitleBar\r\n                title={t('Common.PendingList')}\r\n                onBack={() => {\r\n                    navigation.reset({\r\n                        index: 0,\r\n                        routes: [{ name: 'Home' }]\r\n                    });\r\n                }}\r\n            />\r\n            {\r\n                error ?\r\n                    <ErrorPage title={error} onRetry={init} /> :\r\n                    <Loading />\r\n            }\r\n        </Container>\r\n    )\r\n});\r\n\r\nexport default ModifyPage;\r\n"],"mappings":"6HAAA,OAASA,cAAT,CAAyBC,aAAzB,KAA8C,0BAA9C,CACA,OAASC,QAAT,KAAyB,YAAzB,CACA,OAASC,SAAT,KAA0B,aAA1B,CACA,MAAOC,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,MAA1B,CAAkCC,SAAlC,KAAmD,OAAnD,CACA,OAASC,cAAT,KAA+B,eAA/B,CACA,OAASC,UAAT,yBACA,MAAOC,CAAAA,QAAP,iCACA,OAASC,SAAT,oBACA,MAAOC,CAAAA,SAAP,gBACA,MAAOC,CAAAA,OAAP,kBACA,MAAO,GAAKC,CAAAA,aAAZ,KAA+B,oBAA/B,C,wFAEA,GAAMC,CAAAA,UAAU,CAAGb,QAAQ,CAAC,UAAM,CAC9B,GAAMc,CAAAA,MAAM,CAAGL,SAAS,EAAxB,CACA,oBAAoBH,cAAc,EAAlC,CAAQS,IAAR,iBAAQA,IAAR,CAAcC,CAAd,iBAAcA,CAAd,CACA,GAAMC,CAAAA,UAAU,CAAGlB,aAAa,EAAhC,CAEA,cAA0BI,QAAQ,CAAC,EAAD,CAAlC,wCAAOe,KAAP,eAAcC,QAAd,eACA,eAA4BhB,QAAQ,CAAC,KAAD,CAApC,yCAAOiB,MAAP,eAAeC,SAAf,eAEAvB,cAAc,CAAC,UAAM,CACjB,GAAIsB,MAAJ,CAAY,CACR,OACH,CACDE,IAAI,GACP,CALa,CAAd,CAOA,GAAMA,CAAAA,IAAI,CAAG,mNACTD,SAAS,CAAC,IAAD,CAAT,CACAF,QAAQ,CAAC,EAAD,CAAR,CAFS,iDAGcZ,UAAU,CAAC,CAAEO,MAAM,CAANA,MAAF,CAAUG,UAAU,CAAVA,UAAV,CAAsBF,IAAI,CAAJA,IAAtB,CAAD,CAHxB,SAGHQ,QAHG,eAIT,GAAIA,QAAJ,CAAc,CACVJ,QAAQ,CAACI,QAAD,CAAR,CACH,CAEKC,oBARG,CAQyBpB,MAAM,EAR/B,CASHqB,gBATG,CASqBrB,MAAM,EAT3B,CAWHsB,2BAXG,CAW2B,QAA9BA,CAAAA,2BAA8B,CAACC,YAAD,CAAsB,CACtD,GAAGA,YAAY,CAACC,MAAb,GAAwB,UAA3B,CAAsC,CACrC,CACJ,CAdQ,CAgBTvB,SAAS,CAAC,UAAM,CACZiB,IAAI,GAEJG,gBAAgB,CAACI,OAAjB,CAA2BjB,aAAa,CAACkB,uCAAd,CAAsD,SAAAC,QAAQ,CAAI,CACzF,GAAMC,CAAAA,IAAQ,CAAGD,QAAQ,CAACJ,YAAT,CAAsBM,OAAtB,CAA8BC,OAA9B,CAAsCC,IAAtC,CAA2CH,IAA5D,CACAf,UAAU,CAACmB,QAAX,CAAoB,MAApB,CAA4B,CAACC,MAAM,CAAEL,IAAT,CAA5B,EACH,CAH0B,CAA3B,CAKAR,oBAAoB,CAACK,OAArB,CAA+BjB,aAAa,CAAC0B,+BAAd,CAA8CZ,2BAA9C,CAA/B,CAEA,MAAO,WAAM,CACTd,aAAa,CAAC2B,8BAAd,CAA6Cd,gBAA7C,EACH,CAFD,CAIH,CAdQ,CAcN,EAdM,CAAT,CAhBS,sEAAb,CAiCA,MACI,OAAC,SAAD,YACI,KAAC,QAAD,EACI,KAAK,CAAET,CAAC,CAAC,oBAAD,CADZ,CAEI,MAAM,CAAE,iBAAM,CACVC,UAAU,CAACuB,KAAX,CAAiB,CACbC,KAAK,CAAE,CADM,CAEbC,MAAM,CAAE,CAAC,CAAEC,IAAI,CAAE,MAAR,CAAD,CAFK,CAAjB,EAIH,CAPL,EADJ,CAWQzB,KAAK,CACD,KAAC,SAAD,EAAW,KAAK,CAAEA,KAAlB,CAAyB,OAAO,CAAEI,IAAlC,EADC,CAED,KAAC,OAAD,IAbZ,GADJ,CAkBH,CAlE0B,CAA3B,CAoEA,cAAeT,CAAAA,UAAf"},"metadata":{},"sourceType":"module"}