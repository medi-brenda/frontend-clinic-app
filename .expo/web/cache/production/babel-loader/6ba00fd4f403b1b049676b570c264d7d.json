{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";import{useNavigation}from'@react-navigation/native';import{observer}from'mobx-react';import{Container}from'native-base';import React,{useEffect,useState}from'react';import{useTranslation}from'react-i18next';import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import{goSelectBenefit}from\"../../actions/app\";import{getInsurersByClinic}from\"../../actions/config\";import List from\"../../components/list\";import TitleBar from\"../../components/titleBar\";import{useStores}from\"../../stores\";import ErrorPage from\"../error\";import Loading from\"../loading\";import PhoneCall from\"../../components/phoneCall\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SelectInsurerPage=observer(function(){var stores=useStores();var _useTranslation=useTranslation(),i18n=_useTranslation.i18n,t=_useTranslation.t;var navigation=useNavigation();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),inited=_useState4[0],setInited=_useState4[1];var currentTab=stores.appStore.currentTab;var insurers=stores.configStore.insurers;useEffect(function(){init();},[]);var init=function _callee(){var errMsg;return _regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _regeneratorRuntime.awrap(getInsurersByClinic({stores:stores,i18n:i18n}));case 2:errMsg=_context.sent;if(!errMsg){_context.next=5;break;}return _context.abrupt(\"return\",setError(errMsg));case 5:return _context.abrupt(\"return\",setInited(true));case 6:case\"end\":return _context.stop();}}},null,null,null,Promise);};var onItemSelect=function onItemSelect(item){var insurerName;if(i18n.language=='chi'){if(item.code=='6')insurerName='中國人壽 傳統團體';else if(item.code=='7')insurerName='中國人壽 醫加';else insurerName=item.nameChi.split('(')[0].trim();}else{if(item.code=='6')insurerName='China Life Group Medical';else if(item.code=='7')insurerName='China Life MediPlus';else insurerName=item.name;}goSelectBenefit({stores:stores,navigation:navigation,insurer:item.code,insurerName:insurerName});};return _jsxs(Container,{children:[_jsx(TitleBar,{title:t(currentTab+\".SelectInsurer\"),onBack:function onBack(){navigation.reset({index:0,routes:[{name:'Home'}]});}}),error?_jsx(ErrorPage,{title:error,onRetry:init}):!inited?_jsx(Loading,{}):_jsx(List,{data:insurers,icon:\"ios-arrow-forward\",onPress:onItemSelect,formatText:function formatText(item){if(item.code=='6')return'中國人壽 傳統團體 (China Life Group Medical)';else if(item.code=='7')return'中國人壽 醫加 (China Life MediPlus)';return item.nameChi.split('(')[0].trim()+\" (\"+item.nameEn.split('(')[0].trim()+\")\";}}),_jsx(PhoneCall,{})]});});var styleSheet=StyleSheet.create({});export default SelectInsurerPage;","map":{"version":3,"names":["useNavigation","observer","Container","React","useEffect","useState","useTranslation","goSelectBenefit","getInsurersByClinic","List","TitleBar","useStores","ErrorPage","Loading","PhoneCall","SelectInsurerPage","stores","i18n","t","navigation","error","setError","inited","setInited","currentTab","appStore","insurers","configStore","init","errMsg","onItemSelect","item","insurerName","language","code","nameChi","split","trim","name","insurer","reset","index","routes","nameEn","styleSheet","StyleSheet","create"],"sources":["I:/Workspace/mediWS/mccWS/frontend-clinic-app/src/pages/selectInsurers/index.tsx"],"sourcesContent":["import { useNavigation } from '@react-navigation/native';\r\nimport { observer } from 'mobx-react';\r\nimport { Container, View } from 'native-base';\r\nimport React, { useEffect, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Alert, StyleSheet } from 'react-native';\r\nimport { goSelectBenefit } from '../../actions/app';\r\nimport { getInsurersByClinic } from '../../actions/config';\r\nimport List from '../../components/list';\r\nimport TitleBar from '../../components/titleBar';\r\nimport { Insurer } from '../../models/insurer';\r\nimport { useStores } from '../../stores';\r\nimport { translate } from '../../utils/string';\r\nimport ErrorPage from '../error';\r\nimport Loading from '../loading';\r\nimport PhoneCall from \"../../components/phoneCall\";\r\n\r\n\r\nconst SelectInsurerPage = observer(() => {\r\n    const stores = useStores();\r\n    const { i18n, t } = useTranslation();\r\n    const navigation = useNavigation();\r\n\r\n    const [error, setError] = useState('');\r\n    const [inited, setInited] = useState(false);\r\n\r\n    const { currentTab } = stores.appStore;\r\n    const { insurers } = stores.configStore;\r\n\r\n    useEffect(() => {\r\n        init();\r\n    }, []);\r\n\r\n    const init = async () => {\r\n        const errMsg = await getInsurersByClinic({ stores, i18n });\r\n        if (errMsg) {\r\n            return setError(errMsg);\r\n        }\r\n        return setInited(true);\r\n    }\r\n\r\n    const onItemSelect = (item: Insurer) => {\r\n        let insurerName;\r\n        if (i18n.language=='chi'){\r\n            if (item.code=='6')\r\n                insurerName='中國人壽 傳統團體'\r\n            else if (item.code=='7')\r\n                insurerName='中國人壽 醫加'\r\n            else\r\n                insurerName=item.nameChi.split('(')[0].trim();\r\n        }else{\r\n            if (item.code=='6')\r\n                insurerName='China Life Group Medical'\r\n            else if (item.code=='7')\r\n                insurerName='China Life MediPlus'\r\n            else\r\n                insurerName=item.name\r\n        }\r\n        goSelectBenefit({\r\n            stores,\r\n            navigation,\r\n            insurer: item.code,\r\n            insurerName\r\n        });\r\n    }\r\n    return (\r\n        <Container>\r\n            <TitleBar\r\n                title={t(`${currentTab}.SelectInsurer`)}\r\n                onBack={() => {\r\n                    navigation.reset({\r\n                        index: 0,\r\n                        routes: [{ name: 'Home' }]\r\n                    });\r\n                }}\r\n            />\r\n            {\r\n                error ?\r\n                    <ErrorPage title={error} onRetry={init} /> :\r\n                    !inited ? <Loading /> :\r\n                        <List\r\n                            data={insurers}\r\n                            icon='ios-arrow-forward'\r\n                            onPress={onItemSelect}\r\n                            formatText={(item) =>\r\n                                {\r\n                                    if (item.code=='6')\r\n                                        return '中國人壽 傳統團體 (China Life Group Medical)'\r\n                                    else if (item.code=='7')\r\n                                        return '中國人壽 醫加 (China Life MediPlus)'\r\n                                    return `${item.nameChi.split('(')[0].trim()} (${item.nameEn.split('(')[0].trim()})`\r\n                                }\r\n                            }\r\n                        />\r\n            }\r\n\r\n            <PhoneCall/>\r\n        </Container>\r\n    )\r\n});\r\n\r\nconst styleSheet = StyleSheet.create({\r\n});\r\n\r\nexport default SelectInsurerPage;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}