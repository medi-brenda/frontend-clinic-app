{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";import{useFocusEffect,useNavigation}from'@react-navigation/native';import{observer}from'mobx-react';import{Container}from'native-base';import React,{useState,useRef}from'react';import{useTranslation}from'react-i18next';import{initVerify}from\"../../actions/app\";import TitleBar from\"../../components/titleBar\";import{useStores}from\"../../stores\";import ErrorPage from\"../error\";import Loading from\"../loading\";import*as Notifications from'expo-notifications';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var VerifyPage=observer(function(){var stores=useStores();var _useTranslation=useTranslation(),i18n=_useTranslation.i18n,t=_useTranslation.t;var navigation=useNavigation();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),inited=_useState4[0],setInited=_useState4[1];var notificationListener=useRef();var responseListener=useRef();var handlerNotificationReceived=function handlerNotificationReceived(notification){if(notification.origin==='selected'){}};useFocusEffect(function(){if(inited){return;}init();responseListener.current=Notifications.addNotificationResponseReceivedListener(function(response){var page=response.notification.request.content.data.page;navigation.navigate(\"Home\",{screen:page});});notificationListener.current=Notifications.addNotificationReceivedListener(handlerNotificationReceived);return function(){Notifications.removeNotificationSubscription(responseListener);};});var init=function _callee(){var errorMsg;return _regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setInited(true);setError('');_context.next=4;return _regeneratorRuntime.awrap(initVerify({stores:stores,navigation:navigation,i18n:i18n}));case 4:errorMsg=_context.sent;if(errorMsg){setError(errorMsg);}case 6:case\"end\":return _context.stop();}}},null,null,null,Promise);};return _jsxs(Container,{children:[_jsx(TitleBar,{title:t('Common.Verify'),onBack:function onBack(){navigation.reset({index:0,routes:[{name:'Home'}]});}}),error?_jsx(ErrorPage,{title:error,onRetry:init}):_jsx(Loading,{})]});});export default VerifyPage;","map":{"version":3,"names":["useFocusEffect","useNavigation","observer","Container","React","useState","useRef","useTranslation","initVerify","TitleBar","useStores","ErrorPage","Loading","Notifications","VerifyPage","stores","i18n","t","navigation","error","setError","inited","setInited","notificationListener","responseListener","handlerNotificationReceived","notification","origin","init","current","addNotificationResponseReceivedListener","response","page","request","content","data","navigate","screen","addNotificationReceivedListener","removeNotificationSubscription","errorMsg","reset","index","routes","name"],"sources":["I:/Workspace/mediWS/mccWS/frontend-clinic-app/src/pages/verify/index.tsx"],"sourcesContent":["import { useFocusEffect, useNavigation } from '@react-navigation/native';\r\nimport { observer } from 'mobx-react';\r\nimport { Container } from 'native-base';\r\nimport React, { useState, useRef } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { initVerify } from '../../actions/app';\r\nimport TitleBar from '../../components/titleBar';\r\nimport { useStores } from '../../stores';\r\nimport ErrorPage from '../error';\r\nimport Loading from '../loading';\r\nimport * as Notifications from 'expo-notifications';\r\n\r\nconst VerifyPage = observer(() => {\r\n    const stores = useStores();\r\n    const { i18n, t } = useTranslation();\r\n    const navigation = useNavigation();\r\n\r\n    const [error, setError] = useState('');\r\n    const [inited, setInited] = useState(false);\r\n\r\n    const notificationListener: any = useRef<any>();\r\n    const responseListener: any = useRef<any>();\r\n\r\n    const handlerNotificationReceived = (notification:any) => {\r\n        if(notification.origin === 'selected'){\r\n        }\r\n    };\r\n    \r\n    useFocusEffect(() => {\r\n        if (inited) {\r\n            return;\r\n        }\r\n\r\n        init();\r\n\r\n        responseListener.current = Notifications.addNotificationResponseReceivedListener(response => {\r\n            const page:any = response.notification.request.content.data.page;\r\n            navigation.navigate(\"Home\", {screen: page});\r\n        });\r\n\r\n        notificationListener.current = Notifications.addNotificationReceivedListener(handlerNotificationReceived);\r\n\r\n        return () => {\r\n            Notifications.removeNotificationSubscription(responseListener);\r\n        };\r\n    });\r\n\r\n\r\n    const init = async () => {\r\n        setInited(true);\r\n        setError('');\r\n        const errorMsg = await initVerify({ stores, navigation, i18n });\r\n        if (errorMsg) {\r\n            setError(errorMsg);\r\n        }\r\n    }\r\n\r\n    return (\r\n        <Container>\r\n            <TitleBar\r\n                title={t('Common.Verify')}\r\n                onBack={() => {\r\n                    navigation.reset({\r\n                        index: 0,\r\n                        routes: [{ name: 'Home' }]\r\n                    });\r\n                }}\r\n            />\r\n            {\r\n                error ?\r\n                    <ErrorPage title={error} onRetry={init} /> :\r\n                    <Loading />\r\n            }\r\n        </Container>\r\n    )\r\n});\r\n\r\nexport default VerifyPage;"],"mappings":"6HAAA,OAASA,cAAT,CAAyBC,aAAzB,KAA8C,0BAA9C,CACA,OAASC,QAAT,KAAyB,YAAzB,CACA,OAASC,SAAT,KAA0B,aAA1B,CACA,MAAOC,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,MAA1B,KAAwC,OAAxC,CACA,OAASC,cAAT,KAA+B,eAA/B,CACA,OAASC,UAAT,yBACA,MAAOC,CAAAA,QAAP,iCACA,OAASC,SAAT,oBACA,MAAOC,CAAAA,SAAP,gBACA,MAAOC,CAAAA,OAAP,kBACA,MAAO,GAAKC,CAAAA,aAAZ,KAA+B,oBAA/B,C,wFAEA,GAAMC,CAAAA,UAAU,CAAGZ,QAAQ,CAAC,UAAM,CAC9B,GAAMa,CAAAA,MAAM,CAAGL,SAAS,EAAxB,CACA,oBAAoBH,cAAc,EAAlC,CAAQS,IAAR,iBAAQA,IAAR,CAAcC,CAAd,iBAAcA,CAAd,CACA,GAAMC,CAAAA,UAAU,CAAGjB,aAAa,EAAhC,CAEA,cAA0BI,QAAQ,CAAC,EAAD,CAAlC,wCAAOc,KAAP,eAAcC,QAAd,eACA,eAA4Bf,QAAQ,CAAC,KAAD,CAApC,yCAAOgB,MAAP,eAAeC,SAAf,eAEA,GAAMC,CAAAA,oBAAyB,CAAGjB,MAAM,EAAxC,CACA,GAAMkB,CAAAA,gBAAqB,CAAGlB,MAAM,EAApC,CAEA,GAAMmB,CAAAA,2BAA2B,CAAG,QAA9BA,CAAAA,2BAA8B,CAACC,YAAD,CAAsB,CACtD,GAAGA,YAAY,CAACC,MAAb,GAAwB,UAA3B,CAAsC,CACrC,CACJ,CAHD,CAKA3B,cAAc,CAAC,UAAM,CACjB,GAAIqB,MAAJ,CAAY,CACR,OACH,CAEDO,IAAI,GAEJJ,gBAAgB,CAACK,OAAjB,CAA2BhB,aAAa,CAACiB,uCAAd,CAAsD,SAAAC,QAAQ,CAAI,CACzF,GAAMC,CAAAA,IAAQ,CAAGD,QAAQ,CAACL,YAAT,CAAsBO,OAAtB,CAA8BC,OAA9B,CAAsCC,IAAtC,CAA2CH,IAA5D,CACAd,UAAU,CAACkB,QAAX,CAAoB,MAApB,CAA4B,CAACC,MAAM,CAAEL,IAAT,CAA5B,EACH,CAH0B,CAA3B,CAKAT,oBAAoB,CAACM,OAArB,CAA+BhB,aAAa,CAACyB,+BAAd,CAA8Cb,2BAA9C,CAA/B,CAEA,MAAO,WAAM,CACTZ,aAAa,CAAC0B,8BAAd,CAA6Cf,gBAA7C,EACH,CAFD,CAGH,CAjBa,CAAd,CAoBA,GAAMI,CAAAA,IAAI,CAAG,iJACTN,SAAS,CAAC,IAAD,CAAT,CACAF,QAAQ,CAAC,EAAD,CAAR,CAFS,iDAGcZ,UAAU,CAAC,CAAEO,MAAM,CAANA,MAAF,CAAUG,UAAU,CAAVA,UAAV,CAAsBF,IAAI,CAAJA,IAAtB,CAAD,CAHxB,SAGHwB,QAHG,eAIT,GAAIA,QAAJ,CAAc,CACVpB,QAAQ,CAACoB,QAAD,CAAR,CACH,CANQ,qEAAb,CASA,MACI,OAAC,SAAD,YACI,KAAC,QAAD,EACI,KAAK,CAAEvB,CAAC,CAAC,eAAD,CADZ,CAEI,MAAM,CAAE,iBAAM,CACVC,UAAU,CAACuB,KAAX,CAAiB,CACbC,KAAK,CAAE,CADM,CAEbC,MAAM,CAAE,CAAC,CAAEC,IAAI,CAAE,MAAR,CAAD,CAFK,CAAjB,EAIH,CAPL,EADJ,CAWQzB,KAAK,CACD,KAAC,SAAD,EAAW,KAAK,CAAEA,KAAlB,CAAyB,OAAO,CAAES,IAAlC,EADC,CAED,KAAC,OAAD,IAbZ,GADJ,CAkBH,CA/D0B,CAA3B,CAiEA,cAAed,CAAAA,UAAf"},"metadata":{},"sourceType":"module"}